\usepackage{geometry}
\usepackage{tikz}
\usepackage{etoolbox}
\usepackage{tabto}
\usepackage{catchfile}
\usepackage{subfiles}
\usepackage[hidelinks]{hyperref}

% \usepackage{pdfTeX}
% \usepackage[demo]{graphicx}
\usetikzlibrary{positioning, fit, matrix, calc}
\usetikzlibrary{arrows.meta}
\usepackage{datatool}
\usepackage[l3]{csvsimple}
\usepackage{fontspec}
\usepackage{tikzpagenodes}
\usetikzlibrary{calc}
\usetikzlibrary{backgrounds}
\usepackage{anyfontsize}
\usepackage{atbegshi}
\usepackage[hashEnumerators,smartEllipses]{markdown}
\usepackage{contour}
\contourlength{0.8pt} % Adjust for outline thickness
% \usepackage{ifmtarg}% http://ctan.org/pkg/ifmtarg
\usepackage{substr}

\usepackage{xstring}
% \usepackage{xcolor}
\usepackage{graphicx}
% \usepackage[x11names]{xcolor}
% \usepackage[explicit]{titlesec}
\usepackage[newparttoc]{titlesec}
\usepackage{xcolor}
% \usepackage{titletoc}

\usepackage{multirow}
\usepackage{xparse}

\usepackage{wrapfig}

\usepackage{qrcode}
% for settings
    % \usepackage[utf8]{inputenc}
    % \usepackage{xcolor}

\usepackage{fourier, cabin}
\usepackage{linegoal, enumitem}
\usepackage{tabularx}
\usepackage{makecell}
\usepackage{scrextend}

\usepackage{textcomp}
\usepackage{afterpage}
\usepackage{placeins}
\usepackage{amssymb}

\providecommand{\tcversion}{v1.0.0}

\newcommand\underlinedlink[1]{\underline{\nameref{section:mod#1}}}


\geometry{a4paper, lmargin=6mm, rmargin=6mm, tmargin=2.5cm, bmargin=1.5cm}

\definecolor{sec}{HTML}{DD5C14}
\definecolor{band}{HTML}{EE9C52}

% \newfontfamily{\erasfont}{fonts/Eras-Bold-ITC.ttf}[]
\newfontfamily\amatica[
  Path = ../fonts/,
  Scale=1.0
  ] {RacingSansOne-Regular.ttf}
  % ] {Eras-Bold-ITC.ttf}
\newfontfamily\arial[Scale=1.0]{Arial}
\setmainfont[]{PT Sans}

\pgfdeclarelayer{background}
\pgfsetlayers{background,main}


\usepackage{fancyhdr}

\fancypagestyle{plain}{
\fancyhf{} % clear all header and footer fields
\fancyfoot[R]{\amatica\fontsize{19pt}{19pt}\selectfont\thepage} % except the center
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}}
\pagestyle{plain}

\usepackage{xcolor}

\newcommand\boxedsection[1]{{
    \begin{tikzpicture}[inner sep=0pt, inner ysep=0.3ex] 

        \node[inner sep=2mm, outer sep = 1cm, color=white, anchor=base west] at (current page.west) (counter) {\thesection  \hskip0.75ex #1};
        \begin{pgfonlayer}{background}
            \draw[fill=black] (current bounding box.north -| current page.west) rectangle (current page.east |- current bounding box.south);
        \end{pgfonlayer}
    \end{tikzpicture}% 
}}

\newcommand\tocboxedpart[1]{{
  \begin{tikzpicture}[inner sep=0pt, inner ysep=0.3ex]
      \node[
        inner sep=2mm, 
        outer sep=3mm, 
        color=white, 
        anchor=base west,
        font=\amatica\fontsize{14}{14}\selectfont
      ] at (current page.west) (counter) {\thecontentslabel \hskip0.75ex #1};
        \begin{pgfonlayer}{background}
            \draw[fill=black] (current bounding box.north -| current page.west) rectangle (current page.east |- current bounding box.south);
        \end{pgfonlayer}
    \end{tikzpicture}%
}}


\newcommand\boxedsectionx[1]{{
  \begin{tikzpicture}[overlay,remember picture,line width=5pt, inner sep=0pt, inner ysep=0ex, outer sep=0pt]
  \fill[black] (current page.north west) rectangle ($(current page.north east)-(0,3cm)$);
  \fill [black] (current page.north west) rectangle ($(current page.north east)-(0,3cm)$);
  \node[
    rectangle,
    fill=none, 
    draw = none, 
    text = white, 
    minimum width=19cm, 
    minimum height=30mm, 
    font=\amatica\fontsize{17}{17}\selectfont,
    anchor = north
  ] at (current page.north) {#1};
  \end{tikzpicture}%
}}


  \newcommand\custompart[1]{{
  \begin{tikzpicture}[
    myrect/.style={
      rectangle,
      draw,
      inner sep=0pt,
      fit=#1},
    overlay,
    textbox/.style = {
      inner xsep = 2cm,
      inner ysep = 0.2cm,
    },
    remember picture,
    line width=5pt,
    inner sep=0pt,
    inner ysep=0ex
  ]
      \node [rectangle, fill=black, fit=(current page.south west) ($(current page.north east)!0.30!(current page.south east)$)] (partbox) {};

    \node[
      textbox,
    rectangle,
    fill=none, 
    draw = none, 
    text = white, 
    font=\amatica\fontsize{25}{25}\selectfont,
    anchor = north west,
  ] at (partbox.north west) {#1};


  \node[
    textbox,
    rectangle,
    fill=none, 
    draw = none, 
    text = black, 
    font=\amatica\fontsize{25}{25}\selectfont,
    anchor = south west,
  ] at (partbox.north west) {Part \thepart};
  \end{tikzpicture}%
}}

\titleformat{\section}
  {\Large}
  {}
  {0.5ex}
  {\boxedsectionx}

\titleformat{\part}[display]
  {\Large\bfseries}
  {}
  {0mm}
  {\custompart}


\usepackage{titletoc}

\setcounter{tocdepth}{3}
\contentsmargin{2.55em}

\titlecontents{part}[0pc]
{}%
{\tocboxedpart}% 
{}
{}
  
\titlecontents{section}[0pc]
{}%
{\begin{tikzpicture}[baseline={([yshift=-.8ex]current bounding box.center)},]
  \node [
    thick, draw=none, fill=none, rectangle, rounded corners
    ] {\thecontentslabel};
\end{tikzpicture}\quad}
{---}
{$:$ \titlerule[0.5pt]$:$ \large\thecontentspage}

\titlecontents{subsection}[1.8pc]
{}%
{\begin{tikzpicture}[baseline={([yshift=-.8ex]current bounding box.center)},]
\node [
  thick, draw=none, fill=none, rectangle, rounded corners
  ] {\thecontentslabel};
\end{tikzpicture}\quad}
{---}
{$:$ \titlerule[0.5pt]$:$ \large\thecontentspage}

\definecolor{m_orange}{RGB}{255,171,64}
\definecolor{m_green}{RGB}{69, 129, 142}
\definecolor{m_purple}{RGB}{142, 124, 195}
\definecolor{m_lightgray}{RGB}{235, 235, 235}
\definecolor{m_red}{RGB}{224, 102, 102}
\definecolor{mred}{RGB}{224, 102, 102}
\definecolor{mlightgray}{RGB}{235, 235, 235}
\definecolor{vo_green}{RGB}{207, 255, 12}


\makeatletter
\newcommand{\isempty}[1]{%
  \@ifmtarg{#1}{YES}{NO}}
\newcommand{\isnotempty}[1]{% 
  \@ifnotmtarg{#1}{YES}}
\makeatother

\graphicspath{{images/}}

\input{titlepage.tex}